---
title: "Machine Learning / Aprendizagem de M√°quina"
author: "Prof. Dr. Pedro Rafael D. Marinho<br>Departamento de Estat√≠stica - UFPB<br>"
date: '`r Sys.Date()`'
format: 
  revealjs:
    theme: [default, style.scss]
    width: 1920
    height: 1080
    logo: "https://www.ufpb.br/de/contents/imagens/logode.png"
    footer: '<a href="https://www.ufpb.br/de">Departamento de Estat√≠stica da UFPB</a>'
    transition: slide
    background-transition: fade
    preview-links: auto
    slide-number: true
    chalkboard: true
    scrollable: true
    controls: true
    incremental: true  
    code-tools: true
    auto-stretch: true
    code-link: true
revealjs-plugins:
  - pointer
  - attribution
  - roughnotation
filters:
   - roughnotation
execute:
  refresh: true
  warning: false
  error: false
  eval: true
  echo: true
editor: 
  markdown: 
    wrap: 72
lang: pt
---

<!-- ```{r} -->

<!-- #| echo: false -->

<!-- #| warning: false -->

<!-- #| eval: true -->

<!-- if(fs::dir_exists("index_files/")) -->

<!--   fs::dir_delete("index_files/") -->

<!-- ``` -->

::: r-fit-text
Aprendizagem de M√°quina

[Bacharelado em Estat√≠stica]{.flow}

UFPB
:::

#  {.title}

::: r-fit-text
[Apresenta√ß√£o]{.flow}
:::

##  {background-image="https://raw.githubusercontent.com/prdm0/imagens/main/eu.jpg" background-size="contain" background-position="left"}

::: columns
::: {.column width="40%"}
:::

::: {.column width="60%"}
## Sobre mim {.r-fit-text}

<br> <br>

-   Me chamo [Prof. Dr. Pedro Rafael D.
    Marinho](https://prdm.netlify.app/about_pt_br.html){preview-link="true"}.
    Meu curr√≠culo Lattes poder√° ser acessado clicando
    [aqui](http://lattes.cnpq.br/7185368598935272){preview-link="true"}.

-   Sou docente do Departamento de Estat√≠stica da UFPB. üë®‚Äçüè´

-   Toda minha forma√ß√£o acad√™mica √© na √°rea de estat√≠stica (bacharelado
    ao doutorado).

-   Tenho entusiasmo por programa√ß√£o, ci√™ncia de dados e aprendizagem de
    m√°quina üíªüìà.

-   `r fontawesome::fa("github", "black")` Me acompanhe no GitHub:
    <https://github.com/prdm0>.

-   `r fontawesome::fa("linkedin", "black")` Me acompanhe no Linkedin:
    <https://www.linkedin.com/in/prdm0/>.
:::
:::

# O Departamento {.title}

## Meu segundo lar {.r-fit-text background-color="black" background-image="https://raw.githubusercontent.com/prdm0/imagens/main/foto_aerea_ufpb.jpeg" background-size="1600px" background-repeat="repeat" background-opacity="0.35"}

```{r width = 100, height = 100, echo = FALSE, fig.cap="Departamento de Estat√≠stica da UFPB."}
library(leaflet)
leaflet() |>
  addMarkers(-34.846199, -7.140400) |>
  leaflet::addTiles() |>
  setView(
  -34.846199, -7.140400, zoom = 37,
  options = popupOptions(
    minWidth = 1600,
    maxWidth = 1500
  ))
```

## `r fontawesome::fa("laptop-code", "black")` Que linguagem de programa√ß√£o utilizar?

<br>

Nesse curso, ser√° abordado a linguagem de programa√ß√£o [R](https://www.r-project.org/), mas lembre-se que voc√™ poder√° utilizar qualquer linguagem de programa√ß√£o para fazer ci√™ncia de dados. Por√©m, R e Python s√£o as minhas sugest√µes, haja vista que, atualmente, elas s√£o as linguagens com maior quantidade de ferramentas e usu√°rios trabalhando na √°rea de [ci√™ncia de dados](https://en.wikipedia.org/wiki/Data_science).

<br>

[Outros motivos que me leva a lecionar a disciplina utilizando a linguagem R s√£o:]{.black}

1. Possui ferramentas muito bem pensadas para manipula√ß√£o e tratamento de dados;
2. Normalmente, os frameworks de machine learning de R s√£o menos verbosos que os de Python;
3. Matrizes e data frames s√£o estruturas de dados que j√° encontra-se definidas dentro da linguagem, n√£o precisando assim de importar bibliotecas.

Isso √© meu gosto pessoal. √â um gosto que, talvez, faz mais sentido, em se tratando de algu√©m que vem da estat√≠stica. No mercado de trabalho e em seus estudos, ap√≥s cursar as disciplinas de R e Python, fornecidas pelo [Bacharelado em Estat√≠stica da UFPB](https://www.ufpb.br/de), voc√™ ter√° a capacidade de estudar os frameworks de machine learning, aos seus pr√≥prios passos e escolher o que melhor te agrada. A linguagem [Julia](https://julialang.org/) tamb√©m poder√° ser uma √≥tima op√ß√£o.

#  {.title}

::: r-fit-text
[Aprendizagem de M√°quina: O que √©?]{.flow}
:::

## `r fontawesome::fa("robot", "black")` Aprendizagem de m√°quina

<br>

![](gifs/am.gif){.fragment width="800" height="600"}

## `r fontawesome::fa("robot", "black")` Aprendizagem de m√°quina

<br> <br>

**Alguns pontos**:

<br>

1.  A **A**prendizagem de **M**√°quina (AM), tamb√©m chamada de
    **M**achine **L**earning (ML), no ingl√™s, nasceu na d√©cada de 60
    como um campo da intelig√™nica artificial.

2.  Em sua origem, as aplica√ß√µes de AM tinha como objetivo aprender
    padr√µes com base nos dados.

3.  Originalmente, as aplica√ß√µes de AM eram de cunho estritamente
    computacional. Todavia, desde o in√≠cio dos anos 90, a √°rea de
    aprendizagem de m√°quina expandiu seus horizontes e come√ßou a se
    estabelecer como um campo por sim mesma.

4.  Em particular, a √°rea de aprendizagem de m√°quina come√ßou a
    estabelecer muitas intersec√ß√µes com a estat√≠stica. Muitos de seus
    algoritmos s√£o constru√≠dos com base em metodologias que surgiram na
    estat√≠stica.

5.  Atualmente, a comunidade de AM √© bastante interdisciplinar e
    utiliza-se de ideias desenvolvidas em diversas √°reas, sendo a
    estat√≠stica uma delas.

## `r fontawesome::fa("robot", "black")` Tipos de Aprendizado

<br>

[Aprendizado supervisionado]{.black}

<br>

Nesse curso, inicialmente estudaremos problemas de [aprendizado
supervisionado]{.red}, que consiste em aprender a fazer predi√ß√µes a
partir de conjunto de dados em que r√≥tulos (valores da vari√°vel resposta
$Y$) s√£o observados. Trataremos tanto de problemas de regress√£o (estimar
um valor n√∫m√©rico) quanto problemas de classifica√ß√£o (classificar um
cliente como aprovado ou reprovado, em um problema de concess√£o de
cr√©dito). Por exemplo, os [modelos de regress√£o]{.red} s√£o exemplos de
aprendizado supervisionado.

<br>

[Aprendizado n√£o supervisionado]{.black}

<br>

Na segunda parte do curso, aprenderemos alguns m√©todos de aprendizado
[n√£o supervisionado]{.red}, ou seja, algoritmos que n√£o utilizam-se de
r√≥tulos, em que busca-se aprender mais sobre a estrutura dos dados. Por
exemplo, os [m√©todos de agrupamento]{.red} (cluster), s√£o exempƒ∫os de
m√©todos de aprendizado n√£o supervisionado.

## `r fontawesome::fa("robot", "black")` Tipos de Aprendizado

<br>

Muito embora no nosso curso focaremos nas abordagens de aprendizagem
**supervisionada** e **n√£o-supervisionada**, os tipos de aprendizagem,
em geral, podem ser mais amplos, em que temos:

<br>

1.  Aprendizagem supervisionada;
2.  Aprendizagem n√£o-supervisionada;
3.  Aprendizagem semi-supervisionada;
4.  Aprendizagem por refor√ßo.

## O que √© aprender?

<br>

Antes de detalharmos os tipos de aprendizagem de m√°quina, uma d√∫vida que
poder√° surgir √©: ["O que √© aprender?"]{.red}. ["Como a m√°quina
aprende?"]{.red}.

<br>

![](gifs/am.gif){.fragment width="900" height="600"}

## O que √© aprender?

<br>

De forma simples, aprender √© ganhar conhecimento atrav√©s de estudo,
experi√™ncias, por meio de ensinamentos.

<br>

T√°, mais como √© que a [m√°quina]{.red} aprende?

<br>

1.  [Aprendizagem]{.red} √© o processo em que se adquire conhecimento,
    isto √©, √© o processo em que utilizamos de algoritmos e fornecemos
    dados a esses algoritmos para que possamos extrair conhecimento.
    Nesse processo de aprendisagem, os algoritmos fazem uso de dados
    para a extress√£o de conhecimento, atrav√©s de procedimentos
    **supervisionado**, **n√£o-supervisionado**, **semi-supervisionado**
    ou **por refor√ßo**, a depender do algoritmo que voc√™ deseja
    utilizar.

<br>

2.  [Aprendizado]{.red} √© o modelo ajustado, isto √©, √© o conhecimento
    adquirido ap√≥s o treinamamento obtido no processo de aprendizagem.
    Voc√™ poder√° entender como sendo o modelo ajustado e que utilizamores
    para a tomada de decis√µes.

## O que √© aprender?

<br>

Portanto, voc√™ poder√° entender, basiciamente, existe quatro tipos de
aprendizagem, sendo os dois primeiros o que mais focaremos nesse curso e
que de loge s√£o os mais utilizados:

<br>

1.  Aprendizagem supervisionada;
2.  Aprendizagem n√£o-supervisionada;
3.  Aprendizagem semi-supervisionada;
4.  Aprendizagem por refor√ßo.

## Aprendizagem supervisionada

<br>

Nesse tipo de aprendizagem, o algoritmo ir√° receber um conjunto de dados
em que conhecemos r√≥tulos para a vari√°vel de interesse. √â como se voc√™
soubesse onde um bom modelo deve chegar, para assim ser reconhecido como
um bom modelo. Por exemplo,

<br>

1.  [Classifica√ß√£o]{.red}: precisamos determinar a classe de uma
    inst√¢ncia de dados, o seu atributo, i.e.,
    $\widehat{y} = \mathrm{argmax}_y\,P(Y = y\,|\, X = \bf{x})$, em que
    y √© um atributo que desejamos prever (cahorro, gato, sapo), e
    $\bf{x}$ √© um vetor de caracter√≠sticas (peso, altura, comprimento,
    se tem rabo, etc).

<br>

2.  [Regress√£o]{.red}: precisamos estimar uma quantidade num√©rica, i.e.,
    o valor da vari√°vel alvo por meio de uma inst√¢ncia de dados, ou
    seja, precisamos estimar $Y = \mathbb{E}(Y\,|\,X = \bf{x})$, i.e.,
    devemos encontrar meios de obter $\widehat{Y}$.

::: aside
**Algumas observa√ß√µes de nomenclaturas**:

1.  √â comum chamar cada exemplo de dados, i.e., o vetor $\bf{x}$ que
    ser√° passado ao modelo de [atributos]{.red} ou [features]{.red};
2.  Tamb√©m √© comum chamarmos de [r√≥tulo]{.red} ou [label]{.red} a classe
    ou valor alvo, ou seja, estas s√£o as formas de nomearmos $Y$, sendo
    $Y$ uma quantidade num√©rica (modelos de regress√£o) ou n√£o (modelos
    de classifica√ß√£o).
:::

## Aprendizagem supervisionada

<br>

Em se tratando de m√©todos de classifica√ß√£o, podemos ter os m√©todos:

<br>

1.  [Generativos]{.red}: s√£o os m√©todos que dada as vari√°veis $X$ e $Y$,
    o objetivo √© encontrar a distribui√ß√£o de probabilidade conjunta
    $P(X, Y)$, para ent√£o poder determinar $P(Y\, | \, X = \bf{x})$.
    Alguns m√©todos s√£o:

    -   Naive Bayes;
    -   Descriminante linear.

<br>

2.  [Descriminativos]{.red}: s√£o os m√©todos que estimam diretamente a
    probabilidade condicional $P(Y \, | \, X = \bf{x})$ ou que mesmo nem
    assumem modelos probabil√≠sticos. Podemos citar:
    -   Regress√£o logistica;
    -   Perceptron;
    -   Support Vector Machine - SVM.

## Aprendizagem supervisionada

<br>

::: columns
::: {.column width="60%"}
![](gifs/classificacao.webp)
:::

::: {.column width="40%"}
<br> Poder√≠amos estar interessados em classificar o tamanho de morangos:

<br>

1.  S (**S**low): pequeno;

2.  M (**M**edium): m√©dio;

3.  L (**L**arge): grande.
:::
:::

## Aprendizagem supervisionada

<br> <br>

![Mais dois problemas de classifica√ß√£o (linear x
n√£o-linear).](gifs/Classification-Examples.gif){.fragment
fig-align="center" width="900"}

## Aprendizagem supervisionada

<br> <br>

![](gifs/regression.gif){.fragment fig-align="center" width="1200"}

Um exemplo de de um problema de regress√£o. Aqui, a ideia √© utilizar a
equa√ß√£o da reta estimada, a reta que minimiza a soma dos quadrados entre
a reta e os ponto seria a melhor, de modo a ter uma estimativa num√©rica
atrav√©s de novos atributos passado ao modelo, i.e., por meio da equa√ß√£o
da reta e de um novo valor de $x$.

## Aprendizagem supervisionada

<br>

Um outro exemplo seria a classifica√ß√£o de imagem/v√≠deo, utilizando um
algoritmo de rede neural, por exemplo, usando uma **C**onvolutional
**N**eural **N**etwork -
[CNN](https://en.wikipedia.org/wiki/Convolutional_neural_network). Foram
utilizados diversas imagens de pessoas "com" e "sem" m√°scara. Em que
"com" representa detec√ß√£o da m√°scara na face da pessoa e "sem" a n√£o
detec√ß√£o.

<br>

{{< video https://www.youtube.com/watch?v=Zt_Fr7YbU1c width="50%" height="50%" >}}

## Aprendizagem n√£o-supervisionada

<br>

Nesse tipo de aprendizagem, os algoritmos trabalham sobre dados n√£o
rotulados, por exemplo, em uma trarefa de agrupamento.

<br>

Os algoritmos verificam se as inst√¢ncias observadas poder√£o ser
arranjadas de alguma maneira, por exemplo, usando alguma m√©trica de
dist√¢ncia, formando grupos (*clusters*).

<br>

A ideia √© maximizar a dist√¢ncia entre os clusters e minimizar a
dist√¢ncia entre os elementos no interrior do grupo. Em outras palavras,
o que se quer √© tornar os grupos mais diferentes poss√≠veis e tornar os
elementos dos grupos o mais parecido poss√≠vel.

<br>

Aqui, por n√£o haver r√≥tulos, um problema comum √© determinar a quantidade
de grupos ideal que muitas vezes s√£o obtidos de forma subjetiva ou por
heur√≠sticas. A quantidade de grupos √© um dilema!

## Aprendizagem n√£o-supervisionada

<br>

![](gifs/kmeans.gif){.fragment fig-align="center" width="900"}

Ap√≥s a detec√ß√£o dos grupos, √© preciso analisar o resultado de modo a
tentar extrair informa√ß√µes coerentes de modo a saber o que cada grupo
representa no problema em quest√£o.

## Aprendizagem semi-supervisionada

<br>

A aprendizagem semi-supervisionada √© uma abordagem na √°rea de
aprendizagem de m√°quina onde um algoritmo utiliza tanto dados rotulados
quanto n√£o rotulados para treinamento. Por exemplo, algoritmos que
propagam r√≥tulos, como o *Label Propagation*, em que r√≥tulos conhecidos
s√£o propagados para dados n√£o rotulados com base em sua sua proximidade
no espa√ßo de caracter√≠sticas.

<br>

Uma outra abordagem seria misturar modelos (*Model Blending*), em que
diferentes modelos s√£o treinados em diferentes partes do conjunto de
dados, por exemplo, um modelo para a parte roturada e um para a parte
n√£o rotulada.

<br>

![](gifs/hum.gif){.fragment width="50%"}

## Aprendizagem por refor√ßo

<br>

Nesse tipo de aprendizagem, n√£o h√° uma fonte externa de exemplos. O
agente (modelo) aprende aprende com sua pr√≥pria experi√™ncia, por
tentativas e erros, em que voc√™ dever√° definir uma medida de sucesso, e
eventualmente recompensar os acertos. No v√≠deo abaixo, veja um joguinho
que criei em R, onde o carrinho aprendeu a desviar de obst√°culos
aleat√≥rios que aparecem em sua frente. Utilizou-se uma rede neural cuja
a sa√≠da poderia ser ("parado", "para cima" ou "para baixo"). Veja o
c√≥digo clicando
[**aqui**](https://github.com/prdm0/desviando_obstaculos).

<br>

{{< video https://www.youtube.com/watch?v=9NXUtwGkkDw&t=2s width="50%" height="50%" >}}

## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamentom

<br>

Um dos passos mais importante no fluxo de trabalho (*workflow*) de um
modelo de aprendizagem de m√°quina, consiste na prepara√ß√£o dos dados,
onde realizamos transforma√ß√µes, inputa√ß√µes de valores ausentes,
identifica√ß√£o de outliers, remo√ß√£o de vari√°veis altamente
correlacionadas, entre outros.

<br>

Fazer uma an√°lise explorat√≥ria dos dados √© um passo importante para que
se possa entender e detecatar poss√≠veis inconsist√™ncias na base de
dados. N√£o adianta fazer uso de modelos muito sofisticados quando se tem
uma base de dados cheia de problemas.

<br>

Normalmente trabalhamos com juntos de dados (tabelas) relacionais, em
que cada linha √© uma observa√ß√£o e cada coluna representa um atributo do
objeto/observa√ß√£o. A linha de uma base de dados relacional, sem sua a
vari√°vel de interesse, lembre-se que denominamos $Y$ de [r√≥tulo]{.red}
ou [label]{.red}, fornece o vetor de caracter√≠sticas $\bf{x}$ que
descreve uma dada observa√ß√£o.

## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

No artigo [Tidy Data](https://www.jstatsoft.org/article/view/v059i10),
2014, publicado no Journal of Statistical Sofware, o Hadley Wickham
discute que o princ√≠pio de dados organizados est√£o intimamente
relacionados com banco de dados relacional e mais pr√≥ximo do recioc√≠nio
que empregamos na √°lgebra. Nesse artigo, ele define o que √© [Tidy
Dados]{.red}, sendo essa uma maneira de mapear um conjunto de dados.

<br>

Segundo o artigo, um conjunto de dados √© [bagun√ßado]{.red} ou
[arrumado]{.red}/[tidy]{.red}, dependendo de como as linhas, colunas e
tabelas s√£o combinadas com as observa√ß√µes, vari√°veis e tipos. Em dados
arrumados (dados tidy), temos que:

<br>

1.  Cada vari√°vel forma uma coluna;
2.  Cada observa√ß√£o forma uma linha;
3.  Cada valor deve ter sua pr√≥pria c√©lula.

<br>

Embora existam situa√ß√µes em que j√° podemos come√ßar a analisar uma base
de dados real, essa √© a exce√ß√£o e n√£o a regra. Normalmente, nos
deparamos com bases de dados que violam uma ou mais dessas regras.
Sempre, que poss√≠vel, procure utilizar dados no formato [Tidy]{.red}.

## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

<br>

![Representa√ß√£o de uma base de dados no formato tidy.](imgs/tidy-1.png)


## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

<br>

> "As fam√≠lias felizes s√£o todas iguais; toda fam√≠lia infeliz √© infeliz √† sua maneira." -- [Leo Tolstoy](https://en.wikipedia.org/wiki/Leo_Tolstoy)

> "Conjuntos de dados organizados s√£o todos iguais, mas todo conjunto de dados confuso √© confuso √† sua maneira." -- [Hadley Wickham](https://hadley.nz/)

<br>

![Trabalhar com a Tabela do lado esquerdo √© melhor que a Tabela do lado direito. Prefira, sempre que poss√≠vel, o formato tidy. N√£o permita-se ficar estressado t√£o facilmente.](imgs/tidy-2.png){width="50%"}

## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

A linguagem de programa√ß√£o R possue diversas ferramentas que permite manipular e explorar bases de dados. Enumero algumas:


1. [dplyr](https://dplyr.tidyverse.org/): biblioteca que implementa √© uma gram√°tica de manipula√ß√£o de dados, fornecendo um conjunto consistente de verbos que ajudam a resolver os desafios mais comuns de manipula√ß√£o de dados;
2. [tidyr](https://tidyr.tidyverse.org/): ferramentas para ajudar a criar dados organizados, onde cada coluna √© uma vari√°vel, cada linha √© uma observa√ß√£o e cada c√©lula cont√©m um √∫nico valor;
3. [ggplot2](https://ggplot2-book.org/): um sistema para criar gr√°ficos 'declarativamente', baseado no livro [The Grammar of Graphics](https://www.amazon.com.br/Grammar-Graphics-Leland-Wilkinson/dp/0387245448), de [Leland Wilkinson](https://en.wikipedia.org/wiki/Leland_Wilkinson);
4. [visdat](https://docs.ropensci.org/visdat/): uma biblioteca √∫til para um visualiza√ß√£o explorat√≥ria preliminar de dados;
5. [explore](https://github.com/rolkra/explore): biblioteca que apresenta algumas rotinas de an√°lise para realizar uma an√°lise explorat√≥ria nos dados.

Todas essas bibliotecas est√£o muito bem documentadas. √â importante que voc√™s explorem as documentas dessas bibliotecas, pois eventualmente irei utizar alguma delas.

![](gifs/ok.gif)

## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

<br>

No [Cap√≠tulo 12](https://r4ds.had.co.nz/tidy-data.html), do livro [R for Data Science](https://r4ds.had.co.nz/index.html), o autor aborda mais sobre o formato Tidy e como trabalhar com a biblioteca [tidyr](https://tidyr.tidyverse.org/). [Aqui](https://r4ds.had.co.nz/transform.html?q=dplyr#dplyr-basics) o autor aborda de forma b√°sica o pacote [dplyr](https://dplyr.tidyverse.org/).

<br>

Durante o curso, na medida da necessidade de utiliza√ß√£o dessas ferramentas, durante a exposi√ß√£o de exemplos, abordaremos alguns conceitos. Ok?

<br>

![](gifs/ok.gif)

## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

<br>

Muitas vezes, no processo de tratamento dos dados, tamb√©m estamos preocupados em remover atributos que n√£o s√£o significativo para a modelagem, em que nesse momento a experi√™ncia dos especialistas s√£o fundamentais.

<br>

√â comum enriquercermos a base de dados com informa√ß√µes de outras bases de dados, em um sistema de gerenciamento de banco de dados relacional, em que as bases de dados est√£o relacionadas por uma chave. Nesse caso, buscamos por novos atributos para um mesmo objeto (para uma mesma linha da base), em que atributos cruzados devem ter um √∫nico valor, para cada objeto, respeitando a regra tr√™s de conjuntos de dados tidy.

<br>

As vezes transformamos vari√°veis. Por exemplo, √© comum tomar o logaritmo de uma vari√°vel num√©rica que √© assim√©trica, se $x >= 1$, em que $x$ √© um atributo num√©rico qualquer. 

<br>

Em diveras situa√ß√µes, tamb√©m √© comum a base de dados apresentar informa√ß√µes faltantes. Nos data frames de R, a falta de informa√ß√£o na base, normlamente ser√£o representadas por `NA`.


## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

<br>

Poder√° ser que um dado atributo apresente informa√ß√£o faltante, e normalmente n√£o optaremos em remover a observa√ß√£o e precisaremos imputar a informa√ß√£o, por exemplo:

<br>

1. Tomando alguma medida de tend√™ncia central como m√©dia/moda/mediana dos valores que s√£o conhecidos para aquele atributo;
2. Criar um novo valor que √© indica√ß√£o de valor faltante;
3. Usar algoritmos como $k$-nearest neighbors - KNN ($k$ vizinhos mais pr√≥ximos) para imputar valores coerentes;
4. Interpolar os dados.

<br>

Esses s√£o alguns exemplos de como podemos imputar observa√ß√µes faltantes. Muitas vezes n√£o podemos nos dar o luxo de percer observa√ß√µes de nossa base de dados.

## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

<br>

√â comum ser necess√°rio transformar os dados:

1. Pode ser necess√°rio transformar os tipos ou os valores dos atributos para tentar obter um melhor ajuste do modelo;

2. Pode-se discretizar valores cont√≠nuos ou transform√°-los em intervalos;

3. √â comum transformar atributos categ√≥ricos com $p$ categorias, em $p$ novos atributos bin√°rios.
    - [One-hot encoding](https://en.wikipedia.org/wiki/One-hot)
    - [Vari√°veis dummy](https://en.wikipedia.org/wiki/Dummy_variable_(statistics))
    
4. Outra transforma√ß√£o muito comum √© a normaliza√ß√£o dos dados. Normalizar os dados √© muito √∫til quando os atributos num√©ricos possuem escalas muito diferentes.

::: columns

::: {.column width="50%"}
$$X_{novo} = \frac{X - X_{min}}{X_{max} - X_{min}},$$
em que $X_{novo} \in [0, 1].$
:::

::: {.column width="50%"}
$$X_{novo} = Z = \frac{X - \mu}{\sigma^2},$$
em que $\mathbb{E}(X) = \mu$ √© a m√©dia dos dados e $\mathrm{Var}(X) = \sigma^2$. Na pr√°tica, em um contexto de v.a., iids, usamos $\overline{x}$ como estimador de $\mu$ e $S^2$ (vari√¢ncia amostral) como estimador de $\sigma^2$.
:::

:::

## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

<br>

Lembre-se, como citado anteriormente, tomar o logaritmo natural, ou mesmo na base 10 de vari√°veis num√©ricas muito assim√©tricas, poder√° ajudar um pouco, desde que seja possivel tomar o $\log(\cdot)$.

<br>

::: columns

::: {.column width='50%'}

```{r}
set.seed(0)
rgamma(1000, 2, 2) |> 
  hist()
```
:::

::: {.column width='50%'}
```{r}
set.seed(0)
rgamma(1000, 2, 2) |> 
  log() |> hist()
```
:::
:::

## `r fontawesome::fa("database", "black")` Dados: explora√ß√£o e tratamento

<br>

Anteriormente eu citei algumas bibliotecas √∫teis de R para explorar os dados, na fase de tratamento das observa√ß√µes. Por√©m, n√£o estranhe n√£o ter cidado bibliotecas do framework [tidymodels](https://www.tidymodels.org/packages/), em especial o [recipes](https://recipes.tidymodels.org/) que √© muito utilizado no workflow de aprendizagem de m√°quina na fase de pr√©-processamento dos dados. Muitas dessas transforma√ß√µes s√£o aplicadas como receitas de pr√©-processamento com o pacote [recipes](https://recipes.tidymodels.org/).

<br>

O tidymodels ser√° muito √∫til para n√≥s, mas, aos poucos, seu uso e explica√ß√µes mais detalhadas ser√£o apresentadas, apesar que em algumas situa√ß√µes mais simples, poderei n√£o utiliz√°-lo, expor detalhes que eventualmente n√£o ser√° poss√≠vel ou estariam camuflados na utiliza√ß√£o do tidymodels.

<br>

![](gifs/ok-2.gif){width=20%}