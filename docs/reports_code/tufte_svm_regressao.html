<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.176">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof.&nbsp;Dr.&nbsp;Pedro Rafael D. Marinho">

<title>Suport Vector Regression Machine - SVRM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondÃªncias adicionais",
    "search-more-match-text": "mais correspondÃªncia neste documento",
    "search-more-matches-text": "mais correspondÃªncias neste documento",
    "search-clear-button-title": "Limpar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Outros formatos</h2><ul><li><a href="tufte_svm_regressao.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Suport Vector Regression Machine - SVRM</h1>
<p class="subtitle lead">Comparando com outros modelos</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor</div>
    <div class="quarto-title-meta-contents">
             <p>Prof.&nbsp;Dr.&nbsp;Pedro Rafael D. Marinho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Data de PublicaÃ§Ã£o</div>
    <div class="quarto-title-meta-contents">
      <p class="date">24 de julho de 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="carregando-bibliotecas-necessÃ¡rias" class="level2">
<h2 class="anchored" data-anchor-id="carregando-bibliotecas-necessÃ¡rias">Carregando bibliotecas necessÃ¡rias</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidymodels 1.1.0 â”€â”€</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>âœ” broom        1.0.5     âœ” recipes      1.0.6
âœ” dials        1.2.0     âœ” rsample      1.1.1
âœ” dplyr        1.1.2     âœ” tibble       3.2.1
âœ” ggplot2      3.4.2     âœ” tidyr        1.3.0
âœ” infer        1.0.4     âœ” tune         1.1.1
âœ” modeldata    1.1.0     âœ” workflows    1.1.3
âœ” parsnip      1.1.0     âœ” workflowsets 1.0.1
âœ” purrr        1.0.1     âœ” yardstick    1.2.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidymodels_conflicts() â”€â”€
âœ– purrr::discard() masks scales::discard()
âœ– dplyr::filter()  masks stats::filter()
âœ– dplyr::lag()     masks stats::lag()
âœ– recipes::step()  masks stats::step()
â€¢ Learn how to get started at https://www.tidymodels.org/start/</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” forcats   1.0.0     âœ” readr     2.1.4
âœ” lubridate 1.9.2     âœ” stringr   1.5.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– readr::col_factor() masks scales::col_factor()
âœ– purrr::discard()    masks scales::discard()
âœ– dplyr::filter()     masks stats::filter()
âœ– stringr::fixed()    masks recipes::fixed()
âœ– dplyr::lag()        masks stats::lag()
âœ– readr::spec()       masks yardstick::spec()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Resolvendo possÃ­veis conflitos entre o tidymodels e outras bibliotecas</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>tidymodels<span class="sc">::</span><span class="fu">tidymodels_prefer</span>()</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importando-a-base-de-dados" class="level2">
<h2 class="anchored" data-anchor-id="importando-a-base-de-dados">Importando a base de dados</h2>
<p>Utilizando os dados de vinho vermelhoğŸ·, disponÃ­veis <a href="https://www.kaggle.com/datasets/uciml/red-wine-quality-cortez-et-al-2009">aqui</a>, faÃ§a uma pequena anÃ¡lise exploratÃ³ria dos dados. No <a href="https://www.kaggle.com/datasets/uciml/red-wine-quality-cortez-et-al-2009">link</a> do Kaggle vocÃª consegue uma explicaÃ§Ã£o sobre o que significa cada uma das variÃ¡veis.</p>
<p>Os dados, no meu caso, estÃ£o no diretÃ³rio <code>"../dados/winequality-red.csv"</code>. VocÃª deverÃ¡ alterar o <em>path</em> para o diretÃ³rio encontra-se a base que deverÃ¡ ser obtida no link acima.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"../dados/winequality-red.csv"</span>)</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1599 Columns: 12
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
dbl (12): fixed acidity, volatile acidity, citric acid, residual sugar, chlo...

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="uma-exploraÃ§Ã£o-rÃ¡pida-dos-dados" class="level2">
<h2 class="anchored" data-anchor-id="uma-exploraÃ§Ã£o-rÃ¡pida-dos-dados">Uma exploraÃ§Ã£o rÃ¡pida dos dados</h2>
<p>Ã‰ sempre importante olhar os dados antes de tentar modelar. Uma anÃ¡lise exploratÃ³ria sempre serÃ¡ Ãºtil para identificarmos possÃ­veis inconsistÃªncias.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">vis_dat</span>(dados)</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tufte_svm_regressao_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>O grÃ¡fico acima mostra que temos uma base de dados sem informaÃ§Ãµes faltantes e todas as <em>features</em> presentes na base sÃ£o numÃ©ricas. Ã‰ uma situaÃ§Ã£o confortÃ¡vel, haja vista que, aqui, nÃ£o precisaremos nos preocupar com imputaÃ§Ã£o de dados faltantes.</p>
<p>Um resumo dos dados poderÃ¡ ser obtido utilizando a funÃ§Ã£o <code>glimpse</code> do pacote <strong>dplyr</strong> que Ã© carregado com a biblioteca <strong>tidyverse</strong> de R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,599
Columns: 12
$ `fixed acidity`        &lt;dbl&gt; 7.4, 7.8, 7.8, 11.2, 7.4, 7.4, 7.9, 7.3, 7.8, 7â€¦
$ `volatile acidity`     &lt;dbl&gt; 0.700, 0.880, 0.760, 0.280, 0.700, 0.660, 0.600â€¦
$ `citric acid`          &lt;dbl&gt; 0.00, 0.00, 0.04, 0.56, 0.00, 0.00, 0.06, 0.00,â€¦
$ `residual sugar`       &lt;dbl&gt; 1.9, 2.6, 2.3, 1.9, 1.9, 1.8, 1.6, 1.2, 2.0, 6.â€¦
$ chlorides              &lt;dbl&gt; 0.076, 0.098, 0.092, 0.075, 0.076, 0.075, 0.069â€¦
$ `free sulfur dioxide`  &lt;dbl&gt; 11, 25, 15, 17, 11, 13, 15, 15, 9, 17, 15, 17, â€¦
$ `total sulfur dioxide` &lt;dbl&gt; 34, 67, 54, 60, 34, 40, 59, 21, 18, 102, 65, 10â€¦
$ density                &lt;dbl&gt; 0.9978, 0.9968, 0.9970, 0.9980, 0.9978, 0.9978,â€¦
$ pH                     &lt;dbl&gt; 3.51, 3.20, 3.26, 3.16, 3.51, 3.51, 3.30, 3.39,â€¦
$ sulphates              &lt;dbl&gt; 0.56, 0.68, 0.65, 0.58, 0.56, 0.56, 0.46, 0.47,â€¦
$ alcohol                &lt;dbl&gt; 9.4, 9.8, 9.8, 9.8, 9.4, 9.4, 9.4, 10.0, 9.5, 1â€¦
$ quality                &lt;dbl&gt; 5, 5, 5, 6, 5, 5, 5, 7, 7, 5, 5, 5, 5, 5, 5, 5,â€¦</code></pre>
</div>
</div>
<p>Ã‰ possÃ­vel todas as correlaÃ§Ãµes entre todas as variÃ¡veis da base, com a funÃ§Ã£o <code>data_vis_cor</code>. Um grÃ¡fico Ãºtil com as correlaÃ§Ãµes poderÃ¡ ser obtido usando a funÃ§Ã£o <code>vis_cor</code>, conforme abaixo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">data_vis_cor</span>(dados)</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 144 Ã— 3
   row_1         row_2                  value
   &lt;chr&gt;         &lt;chr&gt;                  &lt;dbl&gt;
 1 fixed acidity fixed acidity         1     
 2 fixed acidity volatile acidity     -0.256 
 3 fixed acidity citric acid           0.672 
 4 fixed acidity residual sugar        0.115 
 5 fixed acidity chlorides             0.0937
 6 fixed acidity free sulfur dioxide  -0.154 
 7 fixed acidity total sulfur dioxide -0.113 
 8 fixed acidity density               0.668 
 9 fixed acidity pH                   -0.683 
10 fixed acidity sulphates             0.183 
# â„¹ 134 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">vis_cor</span>(dados)</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tufte_svm_regressao_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Um grÃ¡fico de scatterplot para as variÃ¡veis numÃ©ricas poderÃ¡ ser Ãºtil. VocÃª poderÃ¡ fazer isso, usando a funÃ§Ã£o <code>ggcatmat</code> do pacote <a href="https://ggobi.github.io/ggally/index.html">GGally</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggscatmat</span>()</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..scaled..`) was deprecated in ggplot2 3.4.0.
â„¹ Please use `after_stat(scaled)` instead.
â„¹ The deprecated feature was likely used in the GGally package.
  Please report the issue at &lt;https://github.com/ggobi/ggally/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="tufte_svm_regressao_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As bibliotecas <strong>GGally</strong> e <strong>skimr</strong> tambÃ©m possuem funÃ§Ãµes Ãºteis que podem nos auxiliar no processo de exploraÃ§Ã£o dos dados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>()</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tufte_svm_regressao_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  skimr<span class="sc">::</span><span class="fu">skim</span>()</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">dados</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">1599</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed acidity</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8.32</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">4.60</td>
<td style="text-align: right;">7.10</td>
<td style="text-align: right;">7.90</td>
<td style="text-align: right;">9.20</td>
<td style="text-align: right;">15.90</td>
<td style="text-align: left;">â–‚â–‡â–‚â–â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">volatile acidity</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">1.58</td>
<td style="text-align: left;">â–…â–‡â–‚â–â–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">citric acid</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">â–‡â–†â–…â–â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">residual sugar</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.54</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">15.50</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">chlorides</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">free sulfur dioxide</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.87</td>
<td style="text-align: right;">10.46</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">14.00</td>
<td style="text-align: right;">21.00</td>
<td style="text-align: right;">72.00</td>
<td style="text-align: left;">â–‡â–…â–â–â–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total sulfur dioxide</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">46.47</td>
<td style="text-align: right;">32.90</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">22.00</td>
<td style="text-align: right;">38.00</td>
<td style="text-align: right;">62.00</td>
<td style="text-align: right;">289.00</td>
<td style="text-align: left;">â–‡â–‚â–â–â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">density</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">â–â–ƒâ–‡â–‚â–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pH</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.31</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">3.31</td>
<td style="text-align: right;">3.40</td>
<td style="text-align: right;">4.01</td>
<td style="text-align: left;">â–â–…â–‡â–‚â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">sulphates</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: left;">â–‡â–…â–â–â–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alcohol</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10.42</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">8.40</td>
<td style="text-align: right;">9.50</td>
<td style="text-align: right;">10.20</td>
<td style="text-align: right;">11.10</td>
<td style="text-align: right;">14.90</td>
<td style="text-align: left;">â–‡â–‡â–ƒâ–â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">quality</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.64</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: left;">â–â–‡â–‡â–‚â–</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="construindo-os-workflows-dos-modelos" class="level2">
<h2 class="anchored" data-anchor-id="construindo-os-workflows-dos-modelos">Construindo os workflows dos modelos</h2>
<p>Iremos comparar os modelos de regressÃ£o linar utilizando <em>elastic net</em>, com o mÃ©todo <span class="math inline">\(k\)</span>NN e <em>suport vector regression machine</em> - SVRM. Buscaremos pelo melhor modelo de cada uma das metodologias consideradas. Posteriormente iremos escolher o melhor modelo entre os melhores de cada uma das classes. A ideia Ã© escolher o melhor modelo que consiga prever melhor a qualidade do vinho, i.e., prever a variÃ¡vel <code>quality</code>.</p>
<section id="tratamento-dos-dados" class="level3">
<h3 class="anchored" data-anchor-id="tratamento-dos-dados">Tratamento dos dados</h3>
<p>Apesar de nÃ£o haver muito o que fazer nos dados que estamos utilizando nesse exemplo, em que nosso objetivo aqui Ã© ter uma anÃ¡lise explicativa de como comparar modelos usando o <a href="https://www.tidymodels.org/">tidymodels</a>, iremos utilizar a biblioteca <a href="https://recipes.tidymodels.org/">recipes</a>. Os dados contÃ©m apenas variÃ¡veis numÃ©ricas com todas informaÃ§Ãµes presentes, tornando o problema um pouco mais simples.</p>
<p><strong>Na receita, iremos colocar as seguintes etapas</strong>:</p>
<ol type="1">
<li>Tomaremos o logarÃ­tmo de todas as variÃ¡veis peditoras (<em>features</em>);</li>
<li>Remover variÃ¡veis preditoras (<em>features</em>) que eventualmente estÃ£o altamente correlacionadas (usando a funÃ§Ã£o <code>step_corr</code>);</li>
<li>Remover variÃ¡veis que possam ter variÃ¢ncia prÃ³xima Ã  zero, i.e., que sejam aproximadamente constantes (usando <code>step_zv</code>);</li>
<li>Normalizar os dados utilizando a funÃ§Ã£o <code>step_normalize</code>.</li>
</ol>
<p>Para que iremos remover variÃ¡veis altamente correlacionadas apenas nas variÃ¡veis preditoras, utilizamos a funÃ§Ã£o <code>all_predictors</code> como argumentod a funÃ§Ã£o <code>step_corr</code>. JÃ¡ no passo de normalizaÃ§Ã£o dos dados, quando consideramos todas as variÃ¡veis numÃ©ricas, passamos para a funÃ§Ã£o <code>step_normalize</code> a funÃ§Ã£o <code>all_numeric</code> que especifica que deverÃ¡ ser normalizado todas as variÃ¡veis numÃ©ricas. Na verdade, a normalizaÃ§Ã£o se dÃ¡ em todas as variÃ¡veis numÃ©ricas, e portanto, esse argumento poderia ser omitido. AlÃ©m disso, toda nossa base Ã© formada por variÃ¡veis numÃ©ricas, o que torna redundante o uso, mas irei deixar explÃ­cito que todas as variÃ¡veis numÃ©ricas estÃ£o sendo normalizadas.</p>
<p>Como fazemos para observar se nosso prÃ©-processamento funcionou?</p>
<p><img src="../gifs/hum.gif" class="img-fluid"></p>
</section>
<section id="partiÃ§Ã£o-dos-dados" class="level3">
<h3 class="anchored" data-anchor-id="partiÃ§Ã£o-dos-dados">PartiÃ§Ã£o dos dados</h3>
<p>Como sabemos, precisamos dividir nossa base de dados em conjunto de treinamento, em que nesse conjunto iremos serÃ¡ realizado o procedimento de validaÃ§Ã£o cruzada e uma base de dados de teste para a avaliaÃ§Ã£o final dos nossos modelos. Deixaremos <span class="math inline">\(80\%\)</span> para o treniamento do modelo e <span class="math inline">\(20\%\)</span> para teste. Iremos estratificar nossa amostra usando a variÃ¡vel <code>quality</code>, variÃ¡vel que queremos estimar (<em>label</em>/rÃ³tulo).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>divisao <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(dados, <span class="at">prop =</span> <span class="fl">0.8</span>, <span class="at">strata =</span> <span class="st">"quality"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>treinamento <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(divisao)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(divisao)</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="definindo-os-modelos" class="level3">
<h3 class="anchored" data-anchor-id="definindo-os-modelos">Definindo os modelos</h3>
<p>O cÃ³digo que segue faz a configuraÃ§Ã£o realiza a configuraÃ§Ã£o dos modelos que serÃ£o comparados. O cÃ³digo <code>tune::tune()</code> especifica que o respectivo parÃ¢metro de sintonizaÃ§Ã£o serÃ¡ obtido no processo de validaÃ§Ã£o cruzada, particularmente, um <em>grid search</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>modelo_elastic <span class="ot">&lt;-</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>(<span class="at">penalty =</span> tune<span class="sc">::</span><span class="fu">tune</span>(), <span class="at">mixture =</span> tune<span class="sc">::</span><span class="fu">tune</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>modelo_knn <span class="ot">&lt;-</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">nearest_neighbor</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">neighbors =</span> tune<span class="sc">::</span><span class="fu">tune</span>(),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist_power =</span> tune<span class="sc">::</span><span class="fu">tune</span>(), </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_func =</span> <span class="st">"gaussian"</span> </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"kknn"</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>modelo_svm <span class="ot">&lt;-</span> </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">svm_rbf</span>(</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">cost =</span> tune<span class="sc">::</span><span class="fu">tune</span>(),</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">rbf_sigma =</span> tune<span class="sc">::</span><span class="fu">tune</span>(),</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin =</span> tune<span class="sc">::</span><span class="fu">tune</span>()</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"kernlab"</span>)</span></code><button title="Copiar para a Ã¡rea de transferÃªncia" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      try { hash = new URL(url).hash; } catch {}
      const id = hash.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note !== null) {
        try {
          const html = processXRef(id, note);
          instance.setContent(html);
        } finally {
          instance.enable();
          instance.show();
        }
      } else {
        // See if we can fetch this
        fetch(url.split('#')[0])
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.getElementById(id);
          if (note !== null) {
            const html = processXRef(id, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>